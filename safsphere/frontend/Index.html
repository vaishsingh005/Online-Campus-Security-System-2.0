<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SafeSphere - Online Campus Security System</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Login Page -->
    <div id="loginPage" class="container">
        <div class="logo">
            <h1>üõ°Ô∏è SafeSphere</h1>
            <p class="subtitle">Online Campus Security System (OCSS)</p>
            <p>Secure ‚Ä¢ Reliable ‚Ä¢ Real-time</p>
        </div>
        
        <div id="loginAlert" class="alert"></div>
        
        <form id="loginForm">
            <div class="form-group">
                <label>Email / User ID</label>
                <input type="text" id="loginEmail" required placeholder="Enter your email or ID">
            </div>
            <div class="form-group">
                <label>Password</label>
                <input type="password" id="loginPassword" required placeholder="Enter your password">
            </div>
            <button type="submit" class="btn">Login</button>
        </form>
        
        <div class="switch-link">
            New user? <a href="#" id="showSignup">Create an account</a>
        </div>
    </div>

    <!-- Signup Page -->
    <div id="signupPage" class="container hidden">
        <div class="logo">
            <h1>üõ°Ô∏è SafeSphere</h1>
            <p class="subtitle">Create Your Account</p>
        </div>
        
        <div id="signupAlert" class="alert"></div>
        
        <form id="signupForm">
            <div class="form-group">
                <label>Full Name</label>
                <input type="text" id="signupName" required placeholder="Enter your full name">
            </div>
            <div class="form-group">
                <label>Email</label>
                <input type="email" id="signupEmail" required placeholder="Enter your email">
            </div>
            <div class="form-group">
                <label>Password</label>
                <input type="password" id="signupPassword" required placeholder="Create a password (min 6 characters)" minlength="6">
            </div>
            <div class="form-group">
                <label>Role</label>
                <select id="signupRole" required>
                    <option value="">Select your role</option>
                    <option value="student">Student</option>
                    <option value="faculty">Faculty</option>
                    <option value="admin">Administrator</option>
                    <option value="security">Security Personnel</option>
                </select>
            </div>
            <div class="form-group">
                <label>ID Number</label>
                <input type="text" id="signupId" required placeholder="Enter your college/employee ID">
            </div>
            <button type="submit" class="btn">Sign Up</button>
        </form>
        
        <div class="switch-link">
            Already have an account? <a href="#" id="showLogin">Login here</a>
        </div>
    </div>

    <!-- Dashboard -->
    <div id="dashboard" class="container dashboard" style="max-width: 1200px;">
        <div class="dashboard-header">
            <div>
                <h2 id="welcomeUser">Welcome!</h2>
                <p id="userRole"></p>
                <p id="userId" style="font-size: 0.9em;"></p>
            </div>
            <button class="btn btn-small" onclick="logout()">Logout</button>
        </div>

        <div class="dashboard-nav" id="dashboardNav">
            <div class="nav-btn active" onclick="showSection('myQr')">
                <h3>üì± My QR Code</h3>
            </div>
            <div class="nav-btn" onclick="showSection('attendance')">
                <h3>üìä My Attendance</h3>
            </div>
            <div class="nav-btn" onclick="showSection('scan')" id="scanBtn">
                <h3>üîç Entry/Exit Scan</h3>
            </div>
            <div class="nav-btn" onclick="showSection('visitors')" id="visitorBtn">
                <h3>üë• Visitor Management</h3>
            </div>
            <div class="nav-btn" onclick="showSection('incidents')" id="incidentBtn">
                <h3>‚ö†Ô∏è Incident Reporting</h3>
            </div>
            <div class="nav-btn" onclick="showSection('logs')" id="logsBtn">
                <h3>üìã Entry/Exit Logs</h3>
            </div>
            <div class="nav-btn" onclick="showSection('reports')" id="reportsBtn">
                <h3>üìà Reports & Analytics</h3>
            </div>
            <div class="nav-btn" onclick="showSection('notifications')" id="notifBtn">
                <h3>üîî Notifications</h3>
            </div>
        </div>

        <!-- My QR Code Section -->
        <div id="myQr" class="section active">
            <h3>Your Personal QR Code & ID</h3>
            <div class="qr-display">
                <p>Use this QR code or ID for entry/exit logging</p>
                <div class="id-badge" id="displayUserId"></div>
                <canvas id="qrCanvas"></canvas>
                <p style="margin-top: 10px;"><strong id="qrUserName"></strong></p>
                <p id="qrUserRole"></p>
            </div>
        </div>

        <!-- Attendance Section -->
        <div id="attendance" class="section">
            <h3>My Attendance Record</h3>
            <div class="attendance-card">
                <h4>Attendance Statistics</h4>
                <div class="attendance-stats">
                    <div class="stat-box">
                        <div class="stat-number" id="totalDays">0</div>
                        <div>Total Days</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number" id="presentDays">0</div>
                        <div>Present</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number" id="attendancePercent">0%</div>
                        <div>Attendance %</div>
                    </div>
                </div>
            </div>
            <div id="attendanceList"></div>
        </div>

        <!-- Scan Section -->
        <div id="scanSection" class="section">
            <h3>Entry/Exit Logging</h3>
            <div class="scan-input">
                <p style="margin-bottom: 15px;">Enter User ID or scan QR code</p>
                <div class="form-group">
                    <input type="text" id="scanUserId" placeholder="Enter User ID (e.g., SS1234567890)" style="text-transform: uppercase;">
                </div>
                <div class="action-buttons" style="justify-content: center;">
                    <button class="btn btn-secondary btn-small" onclick="processEntry()">‚úì Entry</button>
                    <button class="btn btn-danger btn-small" onclick="processExit()">‚úó Exit</button>
                </div>
                <div id="scanResult" style="margin-top: 20px;"></div>
            </div>
        </div>

        <!-- Visitors Section -->
        <div id="visitors" class="section">
            <h3>Visitor Management System</h3>
            <div class="visitor-form">
                <h4>Register New Visitor</h4>
                <div class="form-group">
                    <label>Visitor Name *</label>
                    <input type="text" id="visitorName" placeholder="Full name">
                </div>
                <div class="form-group">
                    <label>Purpose of Visit *</label>
                    <input type="text" id="visitorPurpose" placeholder="e.g., Meeting, Interview, Delivery">
                </div>
                <div class="form-group">
                    <label>Contact Number *</label>
                    <input type="tel" id="visitorPhone" placeholder="10-digit mobile number">
                </div>
                <div class="form-group">
                    <label>Person to Meet *</label>
                    <input type="text" id="visitorMeeting" placeholder="Faculty/Staff name">
                </div>
                <div class="form-group">
                    <label>ID Proof Type</label>
                    <select id="visitorIdType">
                        <option value="">Select ID type</option>
                        <option value="aadhar">Aadhar Card</option>
                        <option value="driving">Driving License</option>
                        <option value="voter">Voter ID</option>
                        <option value="passport">Passport</option>
                    </select>
                </div>
                <button class="btn" onclick="registerVisitor()">Register Visitor</button>
            </div>
            <div class="visitor-list">
                <h4>Today's Visitors</h4>
                <div id="visitorsList"></div>
            </div>
        </div>

        <!-- Incident Reporting Section -->
        <div id="incidents" class="section">
            <h3>Incident Reporting</h3>
            <div class="incident-form">
                <h4>Report an Incident</h4>
                <div class="form-group">
                    <label>Incident Type *</label>
                    <select id="incidentType" required>
                        <option value="">Select incident type</option>
                        <option value="theft">Theft</option>
                        <option value="violence">Violence/Fight</option>
                        <option value="suspicious">Suspicious Activity</option>
                        <option value="medical">Medical Emergency</option>
                        <option value="fire">Fire Hazard</option>
                        <option value="harassment">Harassment</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Location *</label>
                    <input type="text" id="incidentLocation" placeholder="Building, Room number, Area" required>
                </div>
                <div class="form-group">
                    <label>Description *</label>
                    <textarea id="incidentDescription" placeholder="Provide detailed information about the incident" required></textarea>
                </div>
                <div class="form-group">
                    <label>Attach Media (Photo/Video)</label>
                    <div class="file-upload" onclick="document.getElementById('incidentMedia').click()">
                        <p>üì∑ Click to upload photo or video</p>
                        <p style="font-size: 0.85em; color: #666;">Max 5MB</p>
                        <input type="file" id="incidentMedia" accept="image/*,video/*">
                    </div>
                    <p id="mediaFileName" style="margin-top: 10px; color: #667eea;"></p>
                </div>
                <button class="btn" onclick="submitIncident()">Submit Incident Report</button>
            </div>
            <div class="visitor-list">
                <h4>Recent Incidents</h4>
                <div id="incidentsList"></div>
            </div>
        </div>

        <!-- Logs Section -->
        <div id="logs" class="section">
            <h3>Entry/Exit Logs</h3>
            <div class="attendance-card">
                <div class="form-group">
                    <label>Filter by Date</label>
                    <input type="date" id="logDateFilter" onchange="loadLogs()">
                </div>
            </div>
            <div id="logsList"></div>
        </div>

        <!-- Reports Section -->
        <div id="reports" class="section">
            <h3>Reports & Analytics</h3>
            <div class="attendance-card">
                <h4>Today's Summary</h4>
                <div class="attendance-stats">
                    <div class="stat-box">
                        <div class="stat-number" id="totalEntries">0</div>
                        <div>Total Entries</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number" id="currentlyInside">0</div>
                        <div>Currently Inside</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number" id="totalVisitors">0</div>
                        <div>Visitors Today</div>
                    </div>
                </div>
            </div>
            <button class="btn" onclick="generateReport()">Generate Detailed Report</button>
            <div id="detailedReport"></div>
        </div>

        <!-- Notifications Section -->
        <div id="notifications" class="section">
            <h3>Notifications</h3>
            <div id="notificationsList"></div>
        </div>
    </div>

    <!-- SOS Button -->
    <button id="sosButton" class="sos-button hidden" onclick="triggerSOS()">SOS</button>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="script.js"></script>
</body>
</html>